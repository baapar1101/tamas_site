<include name="layouts/header.html" />

<!--main-->
<main class="product-container" product>
	<div class="container">
		<div class="product-context">
			<include name="layouts/breadcrumb.html" />
			<div class="product-header" add-to-cart>
				<div class="row">
					<if terms="@@expiration.exists()">
						<if terms="@@expired">
							<div class="col-sm-12">
								<div class="product-expired">
									<div class="alert alert-danger">
										زمان خرید محصول به پایان رسیده و امکان ثبت سفارش آن وجود ندارد.
									</div>
								</div>
							</div>
						</if>
					</if>
					<div class="col-xl-4">
						<div class="position-relative">
							<!-- expiration -->
							<if terms="@@expiration.exists()">
								<if terms="@@expired.false()">
									<div class="col-sm-12" auto-show>
										<div class="product-expiration">
											<div class="product-expiration-title">
												پیشنهاد شگفت‌انگیز
											</div>
											<div class="product-expiration-countdown" count-down="@@expiration.time.subtract.total.seconds">
												<div class="product-expiration-column days" data-separator=" : ">
													<span class="product-expiration-count">
														{{days}}
													</span>
													<span class="product-expiration-label">
														روز
													</span>
												</div>
												<div class="product-expiration-column hours" data-separator=" : ">
													<span class="product-expiration-count">
														{{hours}}
													</span>
													<span class="product-expiration-label">
														ساعت
													</span>
												</div>
												<div class="product-expiration-column minutes" data-separator=" : ">
													<span class="product-expiration-count">
														{{minutes}}
													</span>
													<span class="product-expiration-label">
														دقیقه
													</span>
												</div>
												<div class="product-expiration-column seconds">
													<span class="product-expiration-count">
														{{seconds}}
													</span>
													<span class="product-expiration-label">
														ثانیه
													</span>
												</div>
											</div>
										</div>
									</div>
								</if>
							</if>

							<!-- actions -->
							<div class="product-actions">
								<if terms="@@user.exists()">
									<button type="button" class="btn btn-link product-addtowishlist" ng-click="submit()" eval="collect(@@id)" ng-class="succeed ? 'btn-danger text-white' : ''" ng-disabled="progress" data-toggle="tooltip" data-original-title="افزودن به فهرست علاقه‌مندی‌ها" add-to-wishlist>
										<i class="fa fa-fw fa-heart-o"></i>
									</button>
								</if>
								<if terms="@@user.empty()">
									<button type="button" class="btn btn-link product-addtowishlist" onclick="alert('این امکان فقط برای کاربران در دسترس است.')">
										<i class="fa fa-fw fa-heart-o"></i>
									</button>
								</if>
								<a href="@@compareurl" class="btn btn-link product-compare" data-toggle="tooltip" title="مقایسه">
									<i class="fa fa-fw fa-balance-scale"></i>
								</a>
							</div>
							<div class="product-image" magnific>
								<a ng-href="{{model.image || '@@image'}}" class="product-image-link" magnific-preview="{{model.image || '@@image?m=thumb&w=1280&h=800&q=high'}}">
									<img ng-src='{{model.image || "@@image.default("/site/resources/images/empty.jpg")"}}?m=thumb&w=1280&h=800&q=high' class="product-image-element" alt="@@title">
								</a>
							</div>
							<if terms='@@images.morethan("1")'>
								<div class="product-images owl-carousel" options="{ navClass: ['product-images-prev', 'product-images-next'], responsive: { 992: { items: 3 }, 1200: { items: 4 } }, loop: false, navText: [], margin: 15, nav: true }" magnific>
									<loop src='@@images'>
										<a href="@@path" magnific-preview="@@path?m=thumb&w=1280&h=800&q=high" class="product-images-link">
											<img src="@@path?m=crop&w=120&h=80&q=high" class="product-images-item">
										</a>
									</loop>
								</div>
							</if>
							<div class="product-images-slider owl-carousel d-none" options="{ navClass: ['product-images-prev', 'product-images-next'], navText: [], nav: true, items: 1 }">
								<loop src="@@images">
									<img src="@@path?m=thumb&w=1280&h=800&q=high" class="product-images-slider-item">
								</loop>
							</div>
						</div>
					</div>
					<div class="col-xl-8">
						<form name="addtocart" class="product-info" ng-submit="addtocart.$valid && submit()" eval="collect(@@price.number, @@compareprice.number, @@discount)" dynamic-form auto-show novalidate>
							<div class="row">
								<div class="col-lg-8">
									<div class="product-data pr-lg-15">
										<if terms="@@user.admin">
											<a href="@@editurl" class="btn btn-sm btn-edit edit-link edit-link-product product-edit">
												<i class="fa fa-pencil"></i>
												ویرایش محصول
											</a>
										</if>
										<h1 class="product-title">
											@@title
										</h1>
										<if terms="@@caption.exists()">
											<h4 class="product-caption">
												<span>@@caption</span>
											</h4>
										</if>
										<if terms="@@rating">
											<div class="product-rating" eval="collect(@@id, @@rate, @@ratecount)" product-rating auto-show>
												<a role="button" class="product-rating-link" ng-click="submit(number)" ng-focus="changeRate(number)" ng-mouseover="changeRate(number)" ng-mouseleave="changeRate()" ng-repeat="number in [1,2,3,4,5]">
													<i class="fa fa-star fa-flip-horizontal text-warning product-rating-link-icon" ng-class="{ 'fa-star-half-o': isHalf(number), 'fa-star-o': model.rate <= number-1 }"></i>
												</a>
												<span class="product-rating-info" ng-show="model.count">
													<small class="text-muted">
														از {{model.count}}
													</small>
												</span>
											</div>
										</if>

										<if terms="@@category.exists()">
											<div class="product-category my-30" store>
												<if terms="@@filters.any()">
													<loop src="@@filters">
														<if terms='@@parentid.equal("id of brand filter")'>
															<div class="product-category-item d-inline-block ml-30">
																برند : 
																<a href="@@category.url?filter=@@id" class="product-category-item-link">
																	@@title
																</a>
															</div>
														</if>
													</loop>
												</if>

												<div class="product-category-item d-inline-block ml-30">
													دسته : 
													<a href="@@category.url" class="product-category-item-link">
														@@category.title
													</a>
												</div>
											</div>
										</if>

										<div class="product-attributes">
											<loop src="@@variants.attributes">
												<div class="form-group product-attribute">
													<div class="input-group align-items-center">
														<div class="input-group-prepend">
															<span class="product-attribute-text pl-10">
																انتخاب @@name:
															</span>
														</div>
														<loop src="@@items">
															<label class="product-attribute-label">
																<input type="radio" value="@@name: @@item" name="item@@_parent.index" ng-model="model.attributes.item@@_parent.index" ng-change="changeAttribute()" required />
																<span class="product-attribute-name">@@item</span>
															</label>
														</loop>
													</div>
													<div class="validation-inline product-attribute-inline-error text-danger" ng-messages="addtocart.item@@index.$error" ng-show="addtocart.$submitted || addtocart.item@@index.$dirty">
														<span ng-message="required">
															@@name را انتخاب کنید.
														</span>
													</div>
												</div>
											</loop>
											<div class="d-none">
												<div class="form-group product-quantity">
													<div class="input-group">
														<div class="input-group-prepend">
															<span class="input-group-text product-quantity-text">
																تعداد
															</span>
														</div>
														<input type="number" id="quantity" class="form-control product-quantity-input" min="1" max="1000" ng-model="model.quantity" ng-disabled="progress" required>
													</div>
												</div>
											</div>
											<div class="d-none">
												<div class="form-group product-variant">
													<div class="input-group">
														<div class="input-group-prepend">
															<span class="input-group-text product-variant-text">
																نوع
															</span>
														</div>
														<select id="variant" class="form-control product-variant-input" ng-disabled="progress">
															<loop src="@@variants">
																<option value="@@id" data-stock="@@stock" data-price="@@price.number" data-compare-price="@@compareprice.number" data-discount="@@discount" data-image="@@image" data-sku="@@sku" product-variant>
																	@@title
																</option>
															</loop>
														</select>
													</div>
												</div>
											</div>
										</div>

										<if terms="@@fields.any()">
											<div class="product-mini-fields-title mt-30 mb-10">ویژگی‌های محصول</div>
											<ul class="product-mini-fields mb-20 p-0 d-none d-md-block">
												<loop src='@@fields.take("4")'>
													<li class="product-mini-fields-item mb-10">
														@@name:
														<loop src="@@values">
															@@value.truncate("50")
														</loop>
													</li>
												</loop>
											</ul>
										</if>

										<!-- product features -->
										<widget type="gallery" name="product:features" section="صفحه محصول">
											<div class="product-features pt-20 d-none d-md-block">
												<div class="row justify-content-center">
													<loop src="@@items">
														<div class="col-3 col-md col-lg">
															<a href="@@url" class="product-features-item d-flex align-items-center mb-15">
																<img src='@@image.default("/site/resources/images/empty.jpg")?m=thumb&w=24&h=24&q=high' alt="@@title" class="product-features-item-image ml-10">
																<span class="product-features-item-title d-block">
																	@@title
																</span>
															</a>
														</div>
													</loop>
												</div>
												<if terms="@@user.admin">
													<div class="text-center mb-15">
														<a href="@@editurl" class="btn btn-sm btn-edit edit-link edit-link-widget">
															<i class="fa fa-pencil"></i>
															ویرایش
														</a>
													</div>
												</if>
											</div>
										</widget>
									</div>
								</div>
								<div class="col-lg-4">
									<div class="product-info-buy p-15">
										<div class="product-seller d-flex align-items-center pt-half pb-15">
											<img class="product-seller-icon img-fluid" src="@@theme/images/store-icon.png" alt="فروشنده">
											<span class="pr-10">فروشنده: @@config.title</span>
										</div>
										<div class="product-availability d-flex align-items-center py-15" ng-class="{ 'd-block': outofstock() }">
											<span class="text-blue" ng-if="!outofstock()">
												<i class="fa fa-check"></i>
												آماده ارسال
											</span>
											<span class="text-gray" ng-if="outofstock()">
												<i class="fa fa-close"></i>
												ناموجود
											</span>
										</div>
										<if terms="@@price.exists">
											<div class="product-price-wrap text-left">
												<if terms="@@compareprice.exists">
													<h5 class="product-compare-price" ng-show="getComparePrice()" ng-bind="getComparePrice()|number">
														@@compareprice
													</h5>
												</if>
												<if terms="@@discount.exists">
													<h5 class="product-discount" ng-show="getDiscount()" ng-bind="getDiscount() + '%'">
														@@discount%
													</h5>
												</if>
												<h5 class="product-price">
													<span ng-bind="getPrice()|number">@@price</span>
													تومان
												</h5>
											</div>
										</if>
										
										<div class="product-buttons">
											<scope name="product-buttons">
												<include name="layouts/validation.html" />
											</scope>
											<if terms="@@inquiry.false() && @@available">
												<button class="btn btn-primary btn-block product-addtocart" ng-disabled="outofstock() || progress">
													<i class="fa fa-fw fa-shopping-cart"></i>
													افزودن به سبدخرید
												</button>
											</if>
											<if terms="@@inquiry">
												<button type="button" class="btn btn-primary btn-block product-inquiry" data-toggle="modal" data-target="#product-inquiry-modal" ng-disabled="progress">
													<i class="fa fa-fw fa-phone-square"></i>
													استعلام محصول
												</button>
											</if>
											<div class="product-buttons-loading" ng-show="progress">
												<i class="fa fa-refresh fa-spin fa-fw"></i>
												کمی صبر کنید...
											</div>
										</div>
									</div>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
			<if terms="@@description.exists()">
				<div class="product-description">
					<p class="product-description-content">
						@@description
					</p>
				</div>
			</if>

			<widget type="products" name="products:relates" terms="@@items.any()">
				<div class="products-wrap bg-white rounded shadow mb-30 py-10 px-30">
					<h2 class="products-title">
						<span>@@title</span>
						<if terms="@@user.admin">
							<a href="@@editurl"
							class="btn btn-sm btn-edit edit-link edit-link-widget">
								<i class="fa fa-pencil"></i>
								ویرایش
							</a>
						</if>
					</h2>
					<div class="owl-container position-relative">
						<div class="products-items owl-carousel"
							options="{
								autoplay: true,
								autoplayTimeout: 4500,
								autoplayHoverPause: true,
								smartSpeed: 500,
								loop: false,
								rtl: true,
								margin: 10,
								responsive:{ 0:{ items: 1.3 }, 375: { items: 2 }, 576: { items: 3 }, 992: { items: 4 }, 1200: { items: 6 } }
							}">
							<loop src="@@items">
								<include name="layouts/components/products-item.html" />
							</loop>
						</div>
					</div>
				</div>
			</widget>

			<div class="product-details" data-tabs="auto">
				<div class="product-details-tabs-container">
					<ul class="nav nav-tabs product-details-tabs" role="tablist">
						<loop src="@@contents">
							<li class="nav-item product-details-tab">
								<a role="button" class="nav-link product-details-tab-link" data-toggle="tab" data-target="#product-content-@@index">
									@@name
								</a>
							</li>
						</loop>
						<if terms="@@fields.any()">
							<li class="nav-item product-details-tab">
								<a role="button" class="nav-link product-details-tab-link" data-toggle="tab" data-target="#product-fields">
									مشخصات
								</a>
							</li>
						</if>
						<if terms="@@comments.enabled || @@comments.any()">
							<li class="nav-item product-details-tab">
								<a role="button" class="nav-link product-details-tab-link" data-toggle="tab" data-target="#product-comments">
									دیدگاه‌ها
								</a>
							</li>
						</if>
					</ul>
				</div>
				<div class="tab-content">
					<loop src="@@contents">
						<div class="tab-pane" id="product-content-@@index">
							<div class="product-content figure-content">
								@@value
							</div>
						</div>
					</loop>
					<if terms="@@fields.any()">
						<div class="tab-pane" id="product-fields">
							<div class="product-fields">
								<loop src="@@fields">
									<div class="row no-gutters product-field">
										<div class="col-lg-3">
											<h6 class="product-field-name">
												@@name
											</h6>
										</div>
										<div class="col-lg-9">
											<loop src="@@values">
												<div class="product-field-value">
													@@value
												</div>
											</loop>
										</div>
									</div>
								</loop>
							</div>
						</div>
					</if>
					<div class="tab-pane" id="product-comments">
						<div class="product-comments">
							<div eval="collect(@@id)" product-commenting auto-show>
								<if terms="@@comments.any()">
									<div class="product-comments" id="comments">
										<loop src="@@comments" recursive="@@subset">
											<div class="media product-comment break-word" id="comment-@@id">
												<div class="d-flex ml-3 product-comment-avatar">
													<img src="@@avatar.get?m=crop&w=100&h=100&q=high" class="product-comment-avatar-image">
												</div>
												<div class="media-body">
													<h5 class="product-comment-author">
														<img src='@@region.format("/site/resources/flags/{0}.gif")' class="product-comment-author-flag">
														<if terms="@@website.empty()">
															<span class="product-comment-name">
																@@name.default("ناشناس")
															</span>
														</if>
														<if terms="@@website.exists()">
															<a href="@@website" rel="nofollow" target="_blank" class="product-comment-website">
																<span>
																	@@name.default("ناشناس")
																</span>
															</a>
														</if>
													</h5>
													<p class="product-comment-body break-word">
														@@body
													</p>
													<span class="product-comment-time">
														<i class="fa fa-clock-o"></i>
														@@time.subtract
													</span>
													<a href="javascript:;" class="btn btn-sm btn-link product-comment-reply" ng-click="reply(@@id)">
														ارسال پاسخ
													</a>
													<if terms="@@rate.exists()">
														<div class="product-comment-rate text-warning">
															<span ng-repeat="number in [1,2,3,4,5]">
																<i class="fa fa-star product-comment-rate-icon" ng-class="{ 'fa-star-o': number > @@rate }"></i>
															</span>
														</div>
													</if>
													<if terms="@@subset.any()">
														<div class="product-comment-subset">
															@@recursive
														</div>
													</if>
												</div>
											</div>
										</loop>
									</div>
								</if>
								<if terms="@@comments.enabled">
									<div class="product-commenting">
										<if terms="@@comments.any()">
											<hr class="page-separator product-separator product-commenting-separator">
										</if>
										<h3 class="product-commenting-title">
											دیدگاه خود را بنویسید
										</h3>
										<form name="commenting" class="product-commenting-form" ng-submit="commenting.$valid && submit()" dynamic-form novalidate>
											<scope name="product-commenting">
												<include name="layouts/validation.html" />
											</scope>
											<div class="alert alert-success product-commenting-succeed" ng-show="succeed">
												<span ng-bind="succeed.description"></span>
											</div>
											<div class="product-commenting-reply-info" ng-show="isreply" ng-click="focusComment()">
												<div class="alert alert-warning">
													این دیدگاه به عنوان پاسخ شما به دیدگاهی دیگر ارسال خواهد شد. برای صرف نظر از ارسال این پاسخ، بر روی گزینه‌ی
													<u>انصراف</u> کلیک کنید.
												</div>
											</div>
											<div class="row">
												<div class="col-md-12">
													<div class="form-group product-commenting-body">
														<textarea id="productcomment-body" name="body" class="form-control product-commenting-body-input" rows="6" placeholder="بنویسید..." ng-model="model.body" ng-disabled="progress" required></textarea>
														<div class="validation-inline product-commenting-inline-error text-danger" ng-messages="commenting.body.$error" ng-show="commenting.$submitted || commenting.body.$dirty">
															<span ng-message="required">
																دیدگاه خود را بنویسید.
															</span>
															<span ng-message="server">
																<span ng-bind="validation.body"></span>
															</span>
														</div>
													</div>
												</div>
												<if terms="@@user.empty()">
													<div class="col-md-6 col-lg-4">
														<div class="form-group product-commenting-name">
															<label for="productcomment-name" class="form-control-label product-commenting-name-label">
																نام و نام خانوادگی
															</label>
															<input type="text" id="productcomment-name" name="name" class="form-control product-commenting-name-input" ng-model="model.name" ng-disabled="progress">
															<div class="validation-inline product-commenting-inline-error text-danger" ng-messages="commenting.name.$error" ng-show="commenting.$submitted || commenting.name.$dirty">
																<span ng-message="server">
																	<span ng-bind="validation.name"></span>
																</span>
															</div>
														</div>
													</div>
													<div class="col-md-6 col-lg-4">
														<div class="form-group product-commenting-email">
															<label for="productcomment-email" class="form-control-label product-commenting-email-label">
																پست الکترونیک
															</label>
															<input type="text" id="productcomment-email" name="email" class="form-control product-commenting-email-input" ng-model="model.email" dir="ltr" ng-disabled="progress">
															<div class="validation-inline product-commenting-inline-error text-danger" ng-messages="commenting.email.$error" ng-show="commenting.$submitted || commenting.email.$dirty">
																<span ng-message="server">
																	<span ng-bind="validation.email"></span>
																</span>
															</div>
														</div>
													</div>
													<div class="col-md-6 col-lg-4">
														<div class="form-group product-commenting-website">
															<label for="productcomment-website" class="form-control-label product-commenting-website-label">
																آدرس وب‌سایت
															</label>
															<input type="text" id="productcomment-website" name="website" class="form-control product-commenting-website-input" ng-model="model.website" dir="ltr" ng-disabled="progress">
															<div class="validation-inline product-commenting-inline-error text-danger" ng-messages="commenting.website.$error" ng-show="commenting.$submitted || commenting.website.$dirty">
																<span ng-message="server">
																	<span ng-bind="validation.website"></span>
																</span>
															</div>
														</div>
													</div>
												</if>
												<if terms="@@rating">
													<div class="col-md-6 col-lg-4">
														<div class="form-group product-commenting-rate">
															<label for="productcomment-rate" class="form-control-label product-commenting-rate-label">
																امتیاز شما به محصول
															</label>
															<select id="productcomment-rate" name="rate" class="form-control product-commenting-rate-input" ng-model="model.rate" ng-disabled="progress">
																<option ng-value="1">یک ستاره</option>
																<option ng-value="2">دو ستاره</option>
																<option ng-value="3">سه ستاره</option>
																<option ng-value="4">چهار ستاره</option>
																<option ng-value="5">پنج ستاره</option>
															</select>
															<div class="validation-inline product-commenting-inline-error text-danger" ng-messages="commenting.rate.$error" ng-show="commenting.$submitted || commenting.rate.$dirty">
																<span ng-message="server">
																	<span ng-bind="validation.rate"></span>
																</span>
															</div>
														</div>
													</div>
												</if>
												<if terms="@@user.exists()">
													<div class="col-md-12">
														دیدگاه شما از طرف
														<mark>@@user</mark> ارسال خواهد شد.
													</div>
												</if>
											</div>
											<button class="btn btn-primary product-commenting-submit" ng-disabled="progress" ng-hide="isreply">
												ارسال دیدگاه
											</button>
											<button class="btn btn-primary product-commenting-submit" ng-disabled="progress" ng-show="isreply">
												ارسال پاسخ
											</button>
											<button type="button" class="btn btn-link product-commenting-reset" ng-disabled="progress" ng-show="commenting.$dirty" ng-click="reset()" click-confirm="همه‌ی اطلاعات نوشته شده، حذف می‌شوند. آیا مطمئن هستید؟">
												انصراف
											</button>
											<div class="product-commenting-loading" ng-show="progress">
												<i class="fa fa-refresh fa-spin fa-fw"></i>
												کمی صبر کنید...
											</div>
										</form>
									</div>
								</if>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</main>
<!--/main-->

<if terms="@@inquiry.false()">
	<include name="layouts/product/partials/addtocart.html" />
</if>
<if terms="@@inquiry">
	<include name="layouts/product/partials/inquiry.html" />
</if>

<include name="layouts/footer.html" />